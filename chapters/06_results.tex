% !TeX root = ../main.tex
% Add the above to each chapter to make compiling the PDF easier in some editors.

\chapter{Results}\label{chapter:results}
\section{Variational Auto Encoder Benchmark}
In this chapter, the following experiments are performed.
For all experiments the test data is used.
Then, an inverse problem is generated.
This is run x times.

\subsection{Latent Dimension}
The latent dimension of the VAE has an effect of the representational error.
With an increase of the latent dimension, the VAE is able to represent more information.
This means the range of the generator is bigger.
The representational error, i.e. the error observed if the complete field is sensed, is smaller.
However, with a bigger range, the search for a point becomes more difficult.
This results in the following [to fill].
\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{figures/06_results/latent_dimension.eps}
    \caption{Latent Dimensions}
\end{figure}
A smaller latent dimension will have a smaller error for few measurements
A bigger latent dimension will have a smaller error for many measurements.

\subsection{Fine-tuned Models vs Base Models}

\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        \multirow{2}{*}{} & \multirow{2}*{\begin{tabular}{c}\textbf{Latent}\\\textbf{Dimension}\end{tabular}} & \multicolumn{3}{c|}{\textbf{City}} \\
        \cline{3-5}
        & & \textbf{Munich} & \textbf{Paris} & \textbf{Zurich} \\
        \hline
        \multirow{4}*{\begin{tabular}{c}\textbf{Relative Error}\\\textbf{Improvement}\end{tabular}}
            & 256 & \textbf{+30.87\%} & \textbf{+29.83\%} & \textbf{+31.32\%} \\
            & 512 & \textbf{+30.60\%} & \textbf{+31.59\%} & \textbf{+33.39\%} \\
            & 1024 & \textbf{+24.55\%} & \textbf{+20.20\%} & \textbf{+25.73\%} \\
            & 2048 & \textbf{+14.66\%} & \textbf{+14.54\%} & \textbf{+21.73\%} \\
        \hline
        \multirow{4}{*}{\begin{tabular}{c}\textbf{SSIM}\\\textbf{Improvement}\end{tabular}}
            & 256 & \textbf{+0.02\%} & \textbf{+5.43\%} & -4.14\% \\
            & 512 & -2.54\% & \textbf{+5.71\%} & -3.69\% \\
            & 1024 & -1.67\% & \textbf{+4.03\%} & -4.61\% \\
            & 2048 & -1.63\% & \textbf{+2.10\%} & -4.53\% \\
        \hline
    \end{tabular}
    \caption{Relative Error and SSIM Improvements from Fine-tuning}
    \label{tab:results}
\end{table}


% \begin{figure}[h!]
%     \centering
%     \includegraphics[width=\textwidth]{figures/06_results/fine_tuned_zuerich.eps}
%     \caption{Results for Fine-tuned Model Zurich}
% \end{figure}
% The other plots can be seen in the appendix.
% Overall, they follow the same trend.

\subsection{VAE vs Lasso}
\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{figures/06_results/gen_vs_lasso.eps}
    \caption{Generative Model vs Lasso}
\end{figure}
Make a graph that keeps num measurements fixed and only varies the noise.

\section{Atmospheric Inversion}
\subsection{Over SNR}
The first run is an SNR plot.
For this run, the artifical footprints from Benjis paper are taken.
Jzst like in his paper, $3\%$ of unknowns measuement stations are used, i.e. 30.
Each measuement station takes $50$ measurements.
The signal to noise ratio is altered.
For each SNR, 3 problems are created to get better sampling.
\begin{figure}
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/snr_plots/munich_relative_error.eps}
        \caption{Relative Error}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/snr_plots/munich_ssim.eps}
        \caption{SSIM}
    \end{subfigure}
    \caption{Results for Munich}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/snr_plots/zürich_relative_error.eps}
        \caption{Relative Error}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/snr_plots/zürich_ssim.eps}
        \caption{SSIM}
    \end{subfigure}
    \caption{Results for Zurich}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/snr_plots/paris_relative_error.eps}
        \caption{Relative Error}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/snr_plots/paris_ssim.eps}
        \caption{SSIM}
    \end{subfigure}
    \caption{Results for Paris}
\end{figure}
Make a plot that has x axis snr and y axis relative error just like in Benjis plot.
Do this for the 3 cities.

\subsection{Example Munich}
The second run is an example to qualitatively assess the performance.
The situation is very favorable with a low to moderate SNR of 20dB.
The chosen city is Munich.
The example run was done with 13 measurement stations.
Each measurement station takes 50 measurements.
This results in 750 measurements.
The guassian plume simulation was run for a predefined wind field.
This wind field covers ~180 degrees.
\begin{figure}
    \centering
    \begin{subfigure}[b]{0.32\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/gaussian_plume_example/munich/target.eps}
        \caption{Target Emissions}
    \end{subfigure}
    \begin{subfigure}[b]{0.32\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/gaussian_plume_example/munich/gen_2048_fine_tuned_20_db.eps}
        \caption{VAE (2048) Fine-tuned}
    \end{subfigure}
    \begin{subfigure}[b]{0.32\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/gaussian_plume_example/munich/gen_2048_20_db.eps}
        \caption{VAE (2048)}
    \end{subfigure}
    \begin{subfigure}[b]{0.32\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/gaussian_plume_example/munich/bp_dct_snr_20_db.eps}
        \caption{SR (DCT)}
    \end{subfigure}    
    \begin{subfigure}[b]{0.32\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/gaussian_plume_example/munich/bp_dwt_snr_20_db.eps}
        \caption{SR (DWT)}
    \end{subfigure}
    \begin{subfigure}[b]{0.32\textwidth}
        \includegraphics[width=\textwidth]{figures/06_results/gaussian_plume_example/munich/least_squares_snr_20_db.eps}
        \caption{LS}
    \end{subfigure}
    \caption{Example Run for Munich}
\end{figure}
The results are reported in the following table.
This also includes the other models that performed worse than the 2048 one.
\begin{table}[h]
    \centering
    \begin{tabular}{|l|c|c|}
        \hline
        \textbf{Solver} & \textbf{Relative Error} & \textbf{SSIM} \\
        \hline
        \hline
        VAE (256) & 54.880\% & 0.426 \\
        VAE (512) & 50.999\% & 0.499 \\
        VAE (1024) & 48.941\% & 0.493 \\
        VAE (2048) & 46.139\% & 0.520 \\
        \hline
        VAE (256) Fine-tuned & 46.333\% & 0.585 \\
        VAE (512) Fine-tuned & 35.974\% & 0.710 \\
        VAE (1024) Fine-tuned & 37.609\% & 0.739 \\
        \textbf{VAE (2048) Fine-tuned} & \textbf{32.833\%} & \textbf{0.751} \\
        \hline
        SR (DWT) & 51.102\% & 0.445 \\
        SR (DCT) & 47.767\% & 0.514 \\
        \hline
        LS & 49.767\% & 0.449 \\
        \hline
    \end{tabular}
    \caption{Relative Error and SSIM for Different Solvers}
    \label{tab:solvers}
\end{table}
TODO: add sum of sensitivities for this example.
